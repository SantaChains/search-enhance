# 📋 Enhance Search Buddy 用户需求规格书 (升级版)

## 🎯 项目背景

用户需要一个功能强大的 Microsoft Edge 浏览器扩展，用于提供智能化的搜索和文本处理体验。该扩展需要支持多种文本格式的自动识别和处理，提供便捷的快捷键操作，并具备专业级的文本分析功能。

---

## 📝 原始需求描述

### 用户原始需求文本
```
设计一个edge浏览器manifest v3拓展
支持浏览其他网页时alt+l弹出悬浮搜索框,不会因点击空白而消失,也支持侧边栏启动.再按alt+l消失,或者叉掉

简单的搜索主页有搜索框和两个开关,还可以自定义搜索引擎默认为必应,自带有秘塔等ai搜索引擎,搜狗,谷歌,谷歌学术,输入纯连接则自动跳转,可以设置保存一定历史记录,数据保存在当前文件夹config.edn文件.支持导入导出,

开关1提取和拆解功能
输入文本弹出常驻选项框(点击空白非输入框范围不会消失),内容
1.对文本内容拆分,如果有链接则先提取出来
2.去除所有中文,中文标点(除了。)，再将中文句号替换为英文.再去除[]和[]里面的内容,所有非url字符
如果得到一个链接,则罗列在下面,多个同理
3.与上面的处理的div相对独立,顶栏是选择拆分原始文本,
按空格,一段数字, 标点符号,分行,一句中文,一句英文.拆分项默认为按英文.
拆分好的文本被小方框包围,一排几个,按窗口断行,每排前面是方框与行号,甚至可以勾选方框一排一排的选择,也可以单个点击或取消,
底栏是复制,旁边可以勾选:每个拆分的词条间是否添加空格,或者换行符,或者制表符,是否全选,是否需要标点
选择情况后,点击刷新拆分,重新按要求排列文字
4.输入本地路径
如"D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md"
或者D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md
则下面罗列以下,左侧有对应的复制按钮,顶上选择复制的内容是否用英语引号""包裹.顺序不变
D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md
file://D:/Users/Jliu%20Pureey/Downloads/gitmine/Edge-Homepage/README.md
D:\\Users\\Jliu Pureey\\Downloads\\gitmine\\Edge-Homepage\\README.md
file:///D:/Users/Jliu%20Pureey/Downloads/gitmine/Edge-Homepage/README.md

开关2当输入类似含有"SantaChains/note"的内容,下面弹出常驻选项框
https://github.com/SantaChains/note
https://zread.ai/SantaChains/note
https://deepwiki.com/SantaChains/note
https://context7.com/SantaChains/note

或者是输入github,zread,context7,deepwiki链接时
自动提取命名空间和仓库,处理为每个完整连接
```

### 后续升级需求
```
整个项目语言使用中文,分析文本格式可以同时采用多种,优化侧边栏的界面显示,支持自动调整.同时学习其他软件,如微信输入法,如何处理剪贴板内容,对应升级到这个程序中来
```

---

## 🔧 功能需求详细分解

### 1. 基础架构需求

#### 1.1 技术规范
- **扩展类型**: Microsoft Edge 浏览器扩展
- **技术标准**: Manifest V3
- **兼容性**: Edge Chromium 88+ 版本

#### 1.2 启动方式
- **快捷键触发**: Alt+L 弹出悬浮搜索框
- **侧边栏支持**: 支持通过侧边栏启动
- **持久显示**: 悬浮框不会因点击页面空白区域而消失
- **关闭方式**: 再次按 Alt+L 或点击关闭按钮

### 2. 用户界面需求

#### 2.1 主界面布局
- **搜索框**: 主要的文本输入区域
- **功能开关**: 两个主要功能开关
  - 开关1: 提取和拆解功能
  - 开关2: 链接生成功能
- **搜索引擎选择**: 下拉菜单选择搜索引擎
- **设置入口**: 配置管理入口

#### 2.2 界面特性
- **语言**: 全中文界面
- **响应式**: 支持自动调整和优化显示
- **常驻选项框**: 功能激活时显示，点击空白不消失

### 3. 搜索引擎需求

#### 3.1 预设搜索引擎
- **默认引擎**: 必应 (Bing)
- **AI 搜索引擎**: 秘塔 (Metaso)
- **传统搜索**: 搜狗、谷歌
- **学术搜索**: 谷歌学术
- **自定义支持**: 用户可添加自定义搜索引擎

#### 3.2 搜索行为
- **纯链接处理**: 输入纯链接时自动跳转
- **搜索历史**: 保存一定数量的搜索历史记录

### 4. 数据存储需求

#### 4.1 存储要求
- **原始需求**: 数据保存在当前文件夹 config.edn 文件
- **实际实现**: 使用 chrome.storage.local API（浏览器安全限制）
- **数据格式**: JSON 格式存储配置信息

#### 4.2 导入导出功能
- **配置导出**: 支持将配置导出为文件
- **配置导入**: 支持从文件导入配置
- **历史记录**: 可配置保存的历史记录数量

### 5. 开关1：提取和拆解功能

#### 5.1 文本处理流程
1.  **链接提取**: 如果文本中有链接，先提取出来
2.  **文本清洗**:
    - 去除所有中文字符
    - 去除中文标点符号（保留句号"。"）
    - 将中文句号"。"替换为英文句号"."
    - 去除方括号"[]"及其内容
    - 去除所有非URL字符
3.  **链接展示**: 提取的链接在下方罗列显示

#### 5.2 文本拆分功能
- **拆分选项**:
  - 按空格拆分
  - 按数字拆分  (注：在最终实现中，此项与按空格合并处理)
  - 按标点符号拆分
  - 按分行拆分
  - 按中文句子拆分
  - 按英文句子拆分
- **默认设置**: 默认按英文句子拆分

#### 5.3 可视化选择
- **显示方式**: 拆分后的文本用小方框包围
- **布局**: 一排显示多个，按窗口宽度自动换行
- **行标识**: 每排前面显示方框和行号
- **选择方式**:
  - 支持单个词条点击选择/取消
  - 支持整行勾选
  - 支持全选功能

#### 5.4 复制功能
- **分隔符选项**:
  - 空格分隔
  - 换行符分隔
  - 制表符分隔
- **格式选项**:
  - 是否包含标点符号 (注：在清洗后已无标点，此选项在最终实现中简化)
  - 是否全选所有词条
- **操作流程**: 选择设置后点击"刷新拆分"重新排列
- **新增逻辑**: **分隔符优先级**: 换行符 > 制表符 > 空格。如果同时勾选多个，只使用最高优先级的一个。

#### 5.5 路径处理功能
- **输入格式**: 支持严格的 Windows 路径格式
  - 带引号: `"D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md"`
  - 不带引号: `D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md`

- **输出格式**: 自动生成四种格式
  1. 原始路径: `D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md`
  2. Unix 风格 File URL: `file:///D:/Users/Jliu%20Pureey/Downloads/gitmine/Edge-Homepage/README.md`
  3. 双反斜杠转义路径: `D:\\Users\\Jliu Pureey\\Downloads\\gitmine\\Edge-Homepage\\README.md`
  4. 替代 File URL: `file://D:\Users\Jliu Pureey\Downloads\gitmine\Edge-Homepage\README.md`

- **复制功能**:
  - 每种格式左侧有对应的复制按钮
  - 顶部选项：是否用英语引号`""`包裹复制内容
  - 保持原有顺序不变

### 6. 开关2：链接生成功能

#### 6.1 输入格式识别
- **仓库格式**: 识别 `username/repository` 格式
  - 示例: `SantaChains/note`
- **完整链接**: 识别以下网站的完整链接
  - GitHub: `https://github.com/username/repo`
  - ZRead: `https://zread.ai/username/repo`
  - Context7: `https://context7.com/username/repo`
  - DeepWiki: `https://deepwiki.com/username/repo`

#### 6.2 链接生成规则
当输入 `SantaChains/note` 时，自动生成：
- `https://github.com/SantaChains/note`
- `https://zread.ai/SantaChains/note`
- `https://deepwiki.com/SantaChains/note`
- `https://context7.com/SantaChains/note`

#### 6.3 反向解析
当输入完整链接时：
- 自动提取命名空间和仓库名
- 生成其他平台的对应链接

### 7. 升级功能需求

#### 7.1 多格式同步分析
- **同时处理**: 分析文本格式时可以同时采用多种处理方式
- **统一显示**: 在一个界面中展示所有检测到的格式结果
- **智能识别**: 自动识别文本类型并应用相应处理

#### 7.2 剪贴板监听功能
- **参考软件**: 学习微信输入法的剪贴板处理方式
- **自动检测**: 监听剪贴板内容变化
- **智能分析**: 自动对剪贴板内容进行格式分析
- **权限管理**: 合理处理剪贴板读取权限

#### 7.3 界面优化
- **侧边栏优化**: 改善侧边栏界面显示效果
- **自动调整**: 支持界面自动调整和适配
- **用户体验**: 提升整体操作体验

---

## 🎨 用户体验需求

### 1. 交互设计
- **即时反馈**: 操作后立即显示结果
- **状态指示**: 清晰的功能状态显示
- **错误处理**: 友好的错误提示信息
- **快捷操作**: 支持键盘快捷键操作

### 2. 视觉设计
- **现代化界面**: 简洁、美观的用户界面
- **一致性**: 统一的视觉风格和交互模式
- **可读性**: 良好的文字对比度和字体选择
- **响应式**: 适配不同窗口尺寸

### 3. 性能要求
- **响应速度**: 文本处理响应时间 < 100ms
- **内存使用**: 合理的内存占用
- **稳定性**: 长时间使用不出现卡顿
- **兼容性**: 良好的浏览器兼容性

---

## 🔒 技术约束与限制

### 1. 浏览器安全限制
- **文件系统访问**: 无法直接读写本地文件系统
- **权限管理**: 需要合理申请和使用浏览器权限
- **跨域限制**: 遵守浏览器同源策略

### 2. Manifest V3 规范
- **Service Worker**: 使用 Service Worker 替代 Background Page
- **权限声明**: 明确声明所需权限
- **内容安全策略**: 遵守 CSP 规范

### 3. 性能约束
- **内存限制**: 合理控制内存使用
- **CPU 使用**: 避免长时间阻塞主线程
- **网络请求**: 最小化不必要的网络请求

---

## 📊 验收标准

### 1. 功能完整性
- ✅ 所有原始需求功能均已实现
- ✅ 升级需求功能均已实现
- ✅ 界面完全中文化
- ✅ 多格式同步分析正常工作
- ✅ 剪贴板监听功能正常

### 2. 用户体验
- ✅ 快捷键 Alt+L 正常工作
- ✅ 悬浮框不会意外消失
- ✅ 侧边栏功能正常
- ✅ 所有复制功能正常工作
- ✅ 配置导入导出正常

### 3. 技术指标
- ✅ 扩展可正常安装和运行
- ✅ 无明显性能问题
- ✅ 无安全漏洞
- ✅ 代码结构清晰，易于维护

### 4. 兼容性
- ✅ Microsoft Edge 88+ 版本兼容
- ✅ 不同屏幕尺寸适配良好
- ✅ 各种文本格式处理正确

---

## 📝 需求变更记录

### 版本 1.0 - 原始需求
- 基础搜索功能
- 两个功能开关
- 路径处理和链接生成
- 配置存储和导入导出

### 版本 2.0 - 升级需求
- 界面全面中文化
- 多格式同步分析
- 剪贴板监听功能
- 界面优化和自动调整

### 版本 3.0 - 完善需求 (当前)
- 详细的功能文档
- 完整的需求规格书
- 技术实现文档
- 用户使用指南

---

## 🎯 项目目标总结

本项目旨在创建一个功能强大、用户友好的浏览器扩展，满足用户对智能文本处理和搜索功能的需求。通过实现上述所有功能需求，为用户提供一个专业级的文本处理工具，提升日常工作效率。

**核心价值**:
- 提供便捷的文本格式转换功能
- 支持多种搜索引擎快速搜索
- 智能识别和处理各种文本格式
- 提供专业的文本拆分和选择功能
- 支持剪贴板内容自动分析

**用户受益**:
- 节省手动格式转换时间
- 提高文本处理效率
- 简化重复性操作
- 提供统一的工具入口
- 支持个性化配置和使用习惯

---

**文档版本**: 1.0 (升级版)
**创建日期**: 2024年
**最后更新**: 2024年
**需求来源**: 用户直接需求描述
**文档状态**: 最终版本