# æµè§ˆå™¨æ‰©å±•å‰ªè´´æ¿å†…å®¹åˆ†æä¸åˆ†è¯æ–¹æ¡ˆè¯¦è§£

## 1. é¡¹ç›®èƒŒæ™¯ä¸éœ€æ±‚

å¸®æˆ‘æœç´¢æ€»ç»“ä¸€ä¸‹,å‰ªè´´æ¿åˆ†è¯,é“¾æ¥åˆ†è¯,ä¸­æ–‡åˆ†è¯æ–¹æ¡ˆçš„é¡¹ç›®.æˆ‘è¦å‚è€ƒä»–ä»¬çš„åˆ†è¯è§„åˆ™,è¦èƒ½å‚è€ƒåŠ©äºå®Œæˆæµè§ˆå™¨æ‹“å±•å‰ªè´´æ¿å†…å®¹çš„åˆ†æ,è¯†åˆ«

## 2. æ ¸å¿ƒåˆ†è¯é¡¹ç›®ä¸è§„åˆ™ï¼ˆç»“æ„åŒ–é€Ÿè§ˆï¼‰

| é¡¹ç›®/å·¥å…· | ç±»å‹ | æ ¸å¿ƒåˆ†è¯è§„åˆ™ | é€‚é…åœºæ™¯ | æµè§ˆå™¨æ‰©å±•å¯ç”¨åº¦ |
| :--- | :--- | :--- | :--- | :--- |
| Jiebaåˆ†è¯ | ä¸­æ–‡åˆ†è¯ | 1. ç²¾ç¡®/å…¨/æœç´¢å¼•æ“3ç§æ¨¡å¼ï¼›2. åŸºäºè¯å…¸æœ€å¤§åŒ¹é…+HMMæœªç™»å½•è¯è¯†åˆ«ï¼›3. æ”¯æŒè‡ªå®šä¹‰è¯å…¸ä¸è¯æ€§æ ‡æ³¨ | æ–‡æœ¬åˆ†æã€å…³é”®è¯æå–ã€å†…å®¹ç»“æ„åŒ– | â˜…â˜…â˜…â˜…â˜…ï¼ˆNode.js/å‰ç«¯é€‚é…ï¼‰ |
| Copylot | å‰ªè´´æ¿æ™ºèƒ½å¤„ç† | 1. ç½‘é¡µå†…å®¹åŒºåŸŸè¯†åˆ«ä¸å™ªéŸ³è¿‡æ»¤ï¼›2. è¡¨æ ¼/ä»£ç å—/åˆ—è¡¨ç­‰æ ¼å¼è¿˜åŸï¼›3. æŒ‰è¯­ä¹‰æ‹†åˆ†æ®µè½ä¸æ ‡é¢˜ | å‰ªè´´æ¿å†…å®¹å‡€åŒ–ã€Markdownè½¬æ¢ | â˜…â˜…â˜…â˜…â˜…ï¼ˆç°æˆæ’ä»¶ï¼Œå¯å¤ç”¨é€»è¾‘ï¼‰ |
| Tiny-segmenter | è½»é‡åˆ†è¯ | 1. åŸºäºN-gramç»Ÿè®¡æ¨¡å‹ï¼›2. è§„åˆ™+ç»Ÿè®¡æ··åˆåˆ†è¯ï¼›3. æ— è¯å…¸ä¾èµ–ï¼Œä½“ç§¯å°ï¼ˆâ‰ˆ1KBï¼‰ | å‰ç«¯è½»é‡åŒ–åˆ†è¯ã€èµ„æºå—é™åœºæ™¯ | â˜…â˜…â˜…â˜…â˜†ï¼ˆçº¯JSï¼Œé€‚åˆæ‰©å±•å†…ç½®ï¼‰ |
| ictclas | ä¸­æ–‡åˆ†è¯ | 1. å¤šå±‚éšé©¬æ¨¡å‹ï¼ˆHMMï¼‰ï¼›2. è¯å…¸+ç»Ÿè®¡æ··åˆåˆ†è¯ï¼›3. æ”¯æŒè¯æ€§æ ‡æ³¨ä¸æœªç™»å½•è¯è¯†åˆ« | é«˜ç²¾åº¦æ–‡æœ¬åˆ†æã€å­¦æœ¯åœºæ™¯ | â˜…â˜…â˜…â˜†â˜†ï¼ˆC++ï¼Œéœ€ç¼–è¯‘ä¸ºWebAssemblyï¼‰ |
| å‰ç«¯å‰ªè´´æ¿è§£ææ–¹æ¡ˆ | å‰ªè´´æ¿å¤„ç† | 1. æŒ‰è¡Œ/æ­£åˆ™åˆ†å‰²å†…å®¹ï¼›2. å…³é”®å­—åŒ¹é…æå–ï¼ˆå¦‚ç”µè¯/åœ°å€/URLï¼‰ï¼›3. ç©ºæ ¼/æ ‡ç‚¹ç¬¦å·åˆ‡åˆ†è§„åˆ™ | è¡¨å•è‡ªåŠ¨å¡«å……ã€ç»“æ„åŒ–æ•°æ®æå– | â˜…â˜…â˜…â˜…â˜…ï¼ˆåŸç”ŸJSï¼Œå³æ’å³ç”¨ï¼‰ |
| Link Parser | é“¾æ¥åˆ†è¯ | 1. æŒ‰URLæ ‡å‡†æ‹†åˆ†åè®®/åŸŸå/è·¯å¾„/æŸ¥è¯¢å‚æ•°ï¼›2. è¯†åˆ«é”šç‚¹ä¸æ–‡ä»¶æ‰©å±•åï¼›3. è¿‡æ»¤æ— æ•ˆé“¾æ¥å­—ç¬¦ | é“¾æ¥æå–ã€è·³è½¬åˆ†æã€å†…å®¹å…³è” | â˜…â˜…â˜…â˜…â˜†ï¼ˆæ­£åˆ™/URL APIåŸç”Ÿæ”¯æŒï¼‰ |
| Segmentit | å‰ç«¯ä¸­æ–‡åˆ†è¯ | 1. åŸºäºè¯å…¸çš„æ­£å‘æœ€å¤§åŒ¹é…ï¼›2. æ”¯æŒè‡ªå®šä¹‰è¯å…¸ï¼›3. çº¯JavaScriptå®ç°ï¼Œè½»é‡é«˜æ•ˆ | å‰ç«¯å®æ—¶åˆ†è¯ã€æµè§ˆå™¨æ‰©å±•é›†æˆ | â˜…â˜…â˜…â˜…â˜…ï¼ˆçº¯JSï¼Œé€‚åˆæµè§ˆå™¨ç¯å¢ƒï¼‰ |

## 3. å…³é”®æŠ€æœ¯å®ç°ä¸ä»£ç ç¤ºä¾‹

### 3.1 å‰ªè´´æ¿æ“ä½œå®ç°

#### 3.1.1 ç°ä»£Clipboard API

```javascript
/**
 * è¯»å–å‰ªè´´æ¿æ–‡æœ¬å†…å®¹
 * @returns {Promise<string>} å‰ªè´´æ¿æ–‡æœ¬å†…å®¹
 */
async function readFromClipboard() {
  try {
    if (navigator.clipboard && navigator.clipboard.readText) {
      const text = await navigator.clipboard.readText();
      return text;
    }
    return null;
  } catch (error) {
    console.error('è¯»å–å‰ªè´´æ¿å¤±è´¥:', error);
    return null;
  }
}

/**
 * å†™å…¥æ–‡æœ¬åˆ°å‰ªè´´æ¿
 * @param {string} text è¦å†™å…¥çš„æ–‡æœ¬
 * @returns {Promise<boolean>} æ˜¯å¦æˆåŠŸ
 */
async function writeToClipboard(text) {
  try {
    if (navigator.clipboard && navigator.clipboard.writeText) {
      await navigator.clipboard.writeText(text);
      return true;
    }
    return false;
  } catch (error) {
    console.error('å†™å…¥å‰ªè´´æ¿å¤±è´¥:', error);
    return false;
  }
}
```

#### 3.1.2 ä¼ ç»ŸexecCommandæ–¹æ³•ï¼ˆå…¼å®¹æ€§æ–¹æ¡ˆï¼‰

```javascript
/**
 * å…¼å®¹æ€§å†™å…¥å‰ªè´´æ¿
 * @param {string} text è¦å†™å…¥çš„æ–‡æœ¬
 * @returns {boolean} æ˜¯å¦æˆåŠŸ
 */
function copyToClipboardFallback(text) {
  try {
    // åˆ›å»ºä¸´æ—¶textareaå…ƒç´ 
    const textarea = document.createElement('textarea');
    textarea.value = text;
    textarea.style.position = 'fixed';
    textarea.style.left = '-999999px';
    textarea.style.top = '-999999px';
    document.body.appendChild(textarea);
    
    // é€‰æ‹©å¹¶å¤åˆ¶
    textarea.focus();
    textarea.select();
    const success = document.execCommand('copy');
    
    // æ¸…ç†
    document.body.removeChild(textarea);
    return success;
  } catch (error) {
    console.error('å¤åˆ¶å¤±è´¥:', error);
    return false;
  }
}
```

### 3.2 é“¾æ¥åˆ†è¯ä¸è§£æ

#### 3.2.1 æ­£åˆ™è¡¨è¾¾å¼æå–é“¾æ¥

```javascript
/**
 * ä»æ–‡æœ¬ä¸­æå–æ‰€æœ‰é“¾æ¥
 * @param {string} text è¾“å…¥æ–‡æœ¬
 * @returns {Array<string>} æå–çš„é“¾æ¥æ•°ç»„
 */
function extractLinks(text) {
  if (!text || typeof text !== 'string') return [];
  
  // åŒ¹é…HTTP/HTTPSé“¾æ¥çš„æ­£åˆ™è¡¨è¾¾å¼
  const urlRegex = /https?:\/\/(?:[\-\w.])+(?::[0-9]+)?(?:\/(?:[\w\/_.\-])*(?:\?(?:[\w&=%.])*)?(?:#(?:[\w.])*)?)?/gi;
  let potentialLinks = text.match(urlRegex) || [];
  
  // åå¤„ç†éªŒè¯
  return [...new Set(potentialLinks.filter(url => {
    try {
      new URL(url);
      return true;
    } catch (_) {
      return false;
    }
  }))];
}
```

#### 3.2.2 URLè§£æä¸åˆ†è¯

```javascript
/**
 * è§£æURLä¸ºç»“æ„åŒ–å¯¹è±¡
 * @param {string} url URLå­—ç¬¦ä¸²
 * @returns {Object|null} è§£æç»“æœ
 */
function parseUrl(url) {
  try {
    const urlObj = new URL(url);
    return {
      protocol: urlObj.protocol,
      hostname: urlObj.hostname,
      port: urlObj.port,
      pathname: urlObj.pathname,
      search: urlObj.search,
      hash: urlObj.hash,
      origin: urlObj.origin,
      // æå–è·¯å¾„æ®µ
      pathSegments: urlObj.pathname.split('/').filter(Boolean),
      // æå–æŸ¥è¯¢å‚æ•°
      searchParams: Object.fromEntries(urlObj.searchParams.entries()),
      // æå–æ–‡ä»¶æ‰©å±•å
      fileExtension: urlObj.pathname.split('.').pop().split('?')[0]
    };
  } catch (error) {
    console.error('URLè§£æå¤±è´¥:', error);
    return null;
  }
}
```

### 3.3 ä¸­æ–‡åˆ†è¯å®ç°

#### 3.3.1 Jiebaåˆ†è¯å‰ç«¯é€‚é…

```javascript
// å¼•å…¥jieba-wasmï¼ˆéœ€è¦é€šè¿‡npmå®‰è£…ï¼‰
// import { load, cut } from 'jieba-wasm';

/**
 * ä¸­æ–‡åˆ†è¯å‡½æ•°
 * @param {string} text ä¸­æ–‡æ–‡æœ¬
 * @param {Object} options åˆ†è¯é€‰é¡¹
 * @returns {Array<string>} åˆ†è¯ç»“æœ
 */
async function chineseSegment(text, options = {}) {
  try {
    // åŠ è½½åˆ†è¯å™¨
    // await load();
    
    // åˆ†è¯é€‰é¡¹
    const {
      mode = 'default', // default, full, search
      HMM = true
    } = options;
    
    // æ‰§è¡Œåˆ†è¯
    // const words = cut(text, mode, HMM);
    // return words;
    
    // è¿™é‡Œä½¿ç”¨ç®€åŒ–å®ç°ï¼Œå®é™…é¡¹ç›®ä¸­æ›¿æ¢ä¸ºjieba-wasm
    return simpleChineseSegment(text);
  } catch (error) {
    console.error('åˆ†è¯å¤±è´¥:', error);
    return [text];
  }
}

/**
 * ç®€åŒ–çš„ä¸­æ–‡åˆ†è¯å®ç°ï¼ˆå¤‡ç”¨æ–¹æ¡ˆï¼‰
 * @param {string} text ä¸­æ–‡æ–‡æœ¬
 * @returns {Array<string>} åˆ†è¯ç»“æœ
 */
function simpleChineseSegment(text) {
  if (!text || typeof text !== 'string') return [];
  
  // åŸºç¡€åˆ†è¯è§„åˆ™
  const rules = [
    // å¸¸è§è¯æ±‡
    'æµè§ˆå™¨', 'æ‰©å±•', 'å‰ªè´´æ¿', 'åˆ†è¯', 'é“¾æ¥', 'æ–‡æœ¬', 'åˆ†æ',
    'æœç´¢', 'å¼•æ“', 'åŠŸèƒ½', 'å®ç°', 'ä»£ç ', 'ç®—æ³•', 'ä¼˜åŒ–'
  ];
  
  let result = [];
  let remaining = text;
  
  // ç®€å•çš„æ­£å‘æœ€å¤§åŒ¹é…
  while (remaining.length > 0) {
    let matched = false;
    
    // å°è¯•åŒ¹é…æœ€é•¿è¯æ±‡
    for (let i = Math.min(remaining.length, 4); i >= 1; i--) {
      const substring = remaining.substring(0, i);
      if (rules.includes(substring) || /[\u4e00-\u9fa5]/.test(substring)) {
        result.push(substring);
        remaining = remaining.substring(i);
        matched = true;
        break;
      }
    }
    
    if (!matched && remaining.length > 0) {
      result.push(remaining.substring(0, 1));
      remaining = remaining.substring(1);
    }
  }
  
  return result;
}
```

### 3.4 å‰ªè´´æ¿å†…å®¹åˆ†æä¸ç»“æ„åŒ–

#### 3.4.1 å†…å®¹ç±»å‹è¯†åˆ«

```javascript
/**
 * è¯†åˆ«å‰ªè´´æ¿å†…å®¹ç±»å‹
 * @param {string} text å‰ªè´´æ¿æ–‡æœ¬
 * @returns {Object} è¯†åˆ«ç»“æœ
 */
function identifyContentType(text) {
  if (!text || typeof text !== 'string') {
    return { type: 'empty', confidence: 1.0 };
  }
  
  const result = {
    type: 'plain',
    confidence: 0.5,
    details: {
      hasLinks: false,
      hasPaths: false,
      hasEmails: false,
      hasPhones: false,
      hasCode: false,
      hasTable: false
    }
  };
  
  // é“¾æ¥æ£€æµ‹
  const links = extractLinks(text);
  if (links.length > 0) {
    result.details.hasLinks = true;
    result.type = 'links';
    result.confidence = 0.8;
  }
  
  // æ–‡ä»¶è·¯å¾„æ£€æµ‹
  const pathRegex = /[a-zA-Z]:\\[^"<>|?*]+|\/[^"<>|?*]+/g;
  if (pathRegex.test(text)) {
    result.details.hasPaths = true;
    if (result.confidence < 0.7) {
      result.type = 'paths';
      result.confidence = 0.7;
    }
  }
  
  // é‚®ç®±æ£€æµ‹
  const emailRegex = /[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g;
  if (emailRegex.test(text)) {
    result.details.hasEmails = true;
  }
  
  // ç”µè¯å·ç æ£€æµ‹
  const phoneRegex = /(?:\+86[\-\s]?)?(?:1[3-9]\d{9}|0\d{2,3}[\-\s]?\d{7,8})/g;
  if (phoneRegex.test(text)) {
    result.details.hasPhones = true;
  }
  
  // ä»£ç æ£€æµ‹
  const codeIndicators = [
    'function', 'const', 'let', 'var', 'if', 'for', 'while', 'return',
    'import', 'export', 'class', 'def', 'print', 'console.log'
  ];
  const codeCount = codeIndicators.filter(indicator => text.includes(indicator)).length;
  if (codeCount > 2) {
    result.details.hasCode = true;
    if (result.confidence < 0.8) {
      result.type = 'code';
      result.confidence = 0.8;
    }
  }
  
  // è¡¨æ ¼æ£€æµ‹
  if (text.includes('\t') || (text.includes('|') && text.split('\n').length > 2)) {
    result.details.hasTable = true;
    if (result.confidence < 0.7) {
      result.type = 'table';
      result.confidence = 0.7;
    }
  }
  
  return result;
}
```

#### 3.4.2 å†…å®¹ç»“æ„åŒ–å¤„ç†

```javascript
/**
 * ç»“æ„åŒ–å¤„ç†å‰ªè´´æ¿å†…å®¹
 * @param {string} text å‰ªè´´æ¿æ–‡æœ¬
 * @returns {Object} ç»“æ„åŒ–ç»“æœ
 */
async function processClipboardContent(text) {
  const result = {
    original: text,
    type: 'unknown',
    processed: '',
    links: [],
    segments: [],
    structuredData: {}
  };
  
  // å†…å®¹ç±»å‹è¯†åˆ«
  const contentType = identifyContentType(text);
  result.type = contentType.type;
  result.structuredData.contentType = contentType;
  
  // æå–é“¾æ¥
  const links = extractLinks(text);
  result.links = links;
  result.structuredData.links = links.map(link => ({
    url: link,
    parsed: parseUrl(link)
  }));
  
  // æ–‡æœ¬åˆ†è¯
  if (contentType.type === 'plain' || contentType.type === 'text') {
    const segments = await chineseSegment(text);
    result.segments = segments;
    result.structuredData.segments = segments;
  }
  
  // è¡¨æ ¼å¤„ç†
  if (contentType.details.hasTable) {
    result.structuredData.table = parseTable(text);
  }
  
  // ä»£ç å¤„ç†
  if (contentType.details.hasCode) {
    result.structuredData.code = extractCodeBlocks(text);
  }
  
  return result;
}

/**
 * è§£æè¡¨æ ¼å†…å®¹
 * @param {string} text åŒ…å«è¡¨æ ¼çš„æ–‡æœ¬
 * @returns {Array<Array<string>>} è¡¨æ ¼æ•°æ®
 */
function parseTable(text) {
  const lines = text.split('\n').filter(line => line.trim());
  const table = [];
  
  for (const line of lines) {
    // å¤„ç†åˆ¶è¡¨ç¬¦åˆ†éš”çš„è¡¨æ ¼
    if (line.includes('\t')) {
      table.push(line.split('\t').map(cell => cell.trim()));
    }
    // å¤„ç†ç®¡é“ç¬¦åˆ†éš”çš„è¡¨æ ¼
    else if (line.includes('|')) {
      table.push(line.split('|').map(cell => cell.trim()).filter(cell => cell));
    }
  }
  
  return table;
}

/**
 * æå–ä»£ç å—
 * @param {string} text åŒ…å«ä»£ç çš„æ–‡æœ¬
 * @returns {Array<string>} ä»£ç å—æ•°ç»„
 */
function extractCodeBlocks(text) {
  const lines = text.split('\n');
  const codeBlocks = [];
  let currentBlock = [];
  let inCodeBlock = false;
  
  for (const line of lines) {
    // ç®€å•çš„ä»£ç å—æ£€æµ‹
    if (line.trim().startsWith('```')) {
      inCodeBlock = !inCodeBlock;
      if (!inCodeBlock && currentBlock.length > 0) {
        codeBlocks.push(currentBlock.join('\n'));
        currentBlock = [];
      }
    } else if (inCodeBlock) {
      currentBlock.push(line);
    } else if (line.trim().startsWith('function ') || line.trim().startsWith('const ') || 
               line.trim().startsWith('let ') || line.trim().startsWith('var ')) {
      // æ£€æµ‹å•è¡Œä»£ç 
      codeBlocks.push(line);
    }
  }
  
  return codeBlocks;
}
```

## 4. å…³é”®è§„åˆ™æ‹†è§£ä¸æ‰©å±•é€‚é…

### 4.1 ä¸­æ–‡åˆ†è¯é€šç”¨è§„åˆ™ï¼ˆJieba/ictclasï¼‰

- **åŒ¹é…ç­–ç•¥**ï¼šæ­£å‘/é€†å‘æœ€å¤§åŒ¹é…ï¼ˆMM/RMMï¼‰ï¼Œä¼˜å…ˆåŒ¹é…æœ€é•¿è¯æ¡ï¼›åŒå‘åŒ¹é…è§£å†³æ­§ä¹‰ã€‚
- **æœªç™»å½•è¯**ï¼šHMMæ¨¡å‹é¢„æµ‹ä½é¢‘è¯è¾¹ç•Œï¼Œæå‡æ–°è¯è¯†åˆ«ç‡ã€‚
- **è‡ªå®šä¹‰è¯å…¸**ï¼šæ”¯æŒæ·»åŠ é¢†åŸŸè¯ï¼ˆå¦‚ç¼–ç¨‹æœ¯è¯­ã€ä¸“æœ‰åè¯ï¼‰ï¼Œé€‚é…æ‰©å±•åœºæ™¯ã€‚
- **æµè§ˆå™¨æ‰©å±•é€‚é…**ï¼šç”¨jieba-wasmæˆ–tiny-segmenterï¼Œé¿å…è¯å…¸ä½“ç§¯è¿‡å¤§ï¼›æŒ‰éœ€åŠ è½½æ¨¡å¼åˆ‡æ¢ã€‚

### 4.2 å‰ªè´´æ¿å†…å®¹å¤„ç†è§„åˆ™ï¼ˆCopylot/å‰ç«¯æ–¹æ¡ˆï¼‰

- **æ ¼å¼è¯†åˆ«**ï¼š
  - è¡¨æ ¼ï¼šæŒ‰åˆ¶è¡¨ç¬¦/ç«–çº¿åˆ†å‰²å•å…ƒæ ¼ï¼Œè¿˜åŸè¡Œåˆ—ç»“æ„ã€‚
  - ä»£ç å—ï¼šè¯†åˆ«è¯­è¨€æ ‡ç­¾ä¸ç¼©è¿›ï¼Œä¿ç•™è¯­æ³•ç»“æ„ã€‚
  - é“¾æ¥ï¼šç”¨æ­£åˆ™`/(https?:\/\/[^\s]+)/g`æå–ï¼Œæ‹†åˆ†URLç»„ä»¶ã€‚
- **å™ªéŸ³è¿‡æ»¤**ï¼šç§»é™¤å¹¿å‘Šã€å¯¼èˆªã€é‡å¤ç©ºæ ¼/æ¢è¡Œç­‰éæ ¸å¿ƒå†…å®¹ã€‚
- **è¯­ä¹‰æ‹†åˆ†**ï¼šæŒ‰æ ‡é¢˜å±‚çº§ï¼ˆh1-h6ï¼‰ã€æ®µè½ã€åˆ—è¡¨é¡¹æ‹†åˆ†ï¼Œç”Ÿæˆç»“æ„åŒ–æ•°æ®ã€‚

### 4.3 é“¾æ¥åˆ†è¯è§„åˆ™ï¼ˆLink Parserï¼‰

1. **åŸºç¡€æ‹†åˆ†**ï¼šä½¿ç”¨URL APIæˆ–æ­£åˆ™æ‹†åˆ†åè®®ï¼ˆhttp/httpsï¼‰ã€åŸŸåã€ç«¯å£ã€è·¯å¾„ã€æŸ¥è¯¢å‚æ•°ã€é”šç‚¹ã€‚
2. **æœ‰æ•ˆæ€§æ ¡éªŒ**ï¼šæ£€æŸ¥åŸŸåæ ¼å¼ã€åè®®åˆæ³•æ€§ï¼Œè¿‡æ»¤æ— æ•ˆé“¾æ¥ã€‚
3. **æ‰©å±•å¤„ç†**ï¼šæå–æ–‡ä»¶ç±»å‹ï¼ˆ.pdf/.docxç­‰ï¼‰ã€å‚æ•°é”®å€¼å¯¹ï¼Œç”¨äºå†…å®¹åˆ†ç±»ã€‚

## 5. æµè§ˆå™¨æ‰©å±•è½åœ°å®ç°

### 5.1 å‰ªè´´æ¿ç›‘æ§ä¸å¤„ç†æµç¨‹

```javascript
/**
 * å‰ªè´´æ¿ç›‘æ§ç±»
 */
class ClipboardMonitor {
  constructor() {
    this.isMonitoring = false;
    this.lastContent = '';
    this.init();
  }

  /**
   * åˆå§‹åŒ–ç›‘æ§
   */
  async init() {
    try {
      const { clipboardMonitoring } = await chrome.storage.local.get('clipboardMonitoring');
      this.isMonitoring = clipboardMonitoring || false;
      
      if (this.isMonitoring) {
        this.startMonitoring();
      }
    } catch (error) {
      console.error('åˆå§‹åŒ–å‰ªè´´æ¿ç›‘æ§å¤±è´¥:', error);
    }
  }

  /**
   * å¼€å§‹ç›‘æ§
   */
  startMonitoring() {
    this.isMonitoring = true;
    this.monitorInterval = setInterval(() => this.checkClipboard(), 1000);
    console.log('å‰ªè´´æ¿ç›‘æ§å·²å¯åŠ¨');
  }

  /**
   * åœæ­¢ç›‘æ§
   */
  stopMonitoring() {
    this.isMonitoring = false;
    if (this.monitorInterval) {
      clearInterval(this.monitorInterval);
      this.monitorInterval = null;
    }
    console.log('å‰ªè´´æ¿ç›‘æ§å·²åœæ­¢');
  }

  /**
   * æ£€æŸ¥å‰ªè´´æ¿å†…å®¹
   */
  async checkClipboard() {
    try {
      const text = await readFromClipboard();
      
      if (!text || text === this.lastContent) {
        return;
      }
      
      this.lastContent = text;
      
      // å¤„ç†å‰ªè´´æ¿å†…å®¹
      const processed = await processClipboardContent(text);
      
      // ä¿å­˜åˆ°å­˜å‚¨
      await chrome.storage.local.set({
        lastClipboardContent: text,
        processedClipboardContent: processed
      });
      
      // é€šçŸ¥å†…å®¹è„šæœ¬
      const [tab] = await chrome.tabs.query({ active: true, currentWindow: true });
      if (tab) {
        try {
          await chrome.tabs.sendMessage(tab.id, {
            action: 'clipboardChanged',
            content: text,
            processed: processed
          });
        } catch (error) {
          // å†…å®¹è„šæœ¬å¯èƒ½æœªåŠ è½½
          console.debug('é€šçŸ¥å†…å®¹è„šæœ¬å¤±è´¥:', error);
        }
      }
      
      console.log('å‰ªè´´æ¿å†…å®¹å·²æ›´æ–°:', processed.type);
    } catch (error) {
      console.error('æ£€æŸ¥å‰ªè´´æ¿å¤±è´¥:', error);
    }
  }

  /**
   * åˆ‡æ¢ç›‘æ§çŠ¶æ€
   */
  toggleMonitoring() {
    if (this.isMonitoring) {
      this.stopMonitoring();
    } else {
      this.startMonitoring();
    }
    
    // ä¿å­˜çŠ¶æ€
    chrome.storage.local.set({ clipboardMonitoring: this.isMonitoring });
    
    return this.isMonitoring;
  }
}
```

### 5.2 å†…å®¹è„šæœ¬é€šçŸ¥å®ç°

```javascript
// src/content/index.js

/**
 * æ˜¾ç¤ºé¡µé¢é€šçŸ¥
 * @param {string} message é€šçŸ¥æ¶ˆæ¯
 * @param {string} type é€šçŸ¥ç±»å‹
 * @param {number} duration æŒç»­æ—¶é—´
 */
function showPageNotification(message, type = 'info', duration = 3000) {
  // æ£€æŸ¥æ˜¯å¦å·²æœ‰é€šçŸ¥
  const existingNotification = document.getElementById('search-buddy-notification');
  if (existingNotification) {
    existingNotification.remove();
  }

  // åˆ›å»ºé€šçŸ¥å…ƒç´ 
  const notification = document.createElement('div');
  notification.id = 'search-buddy-notification';
  notification.style.cssText = `
    position: fixed;
    top: 20px;
    right: 20px;
    z-index: 10000;
    background: ${type === 'success' ? '#10b981' : type === 'error' ? '#ef4444' : '#3b82f6'};
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    font-size: 14px;
    font-weight: 500;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
    animation: slideIn 0.3s ease-out;
    max-width: 350px;
    word-wrap: break-word;
    line-height: 1.4;
  `;

  notification.textContent = `ğŸ” ${message}`;

  // æ·»åŠ æ»‘å…¥åŠ¨ç”»
  const style = document.createElement('style');
  style.textContent = `
    @keyframes slideIn {
      from {
        transform: translateX(100%);
        opacity: 0;
      }
      to {
        transform: translateX(0);
        opacity: 1;
      }
    }
  `;
  document.head.appendChild(style);

  document.body.appendChild(notification);

  // è‡ªåŠ¨ç§»é™¤
  setTimeout(() => {
    if (notification.parentNode) {
      notification.style.animation = 'slideIn 0.3s ease-out reverse';
      setTimeout(() => {
        if (notification.parentNode) {
          notification.remove();
        }
      }, 300);
    }
  }, duration);
}

// ç›‘å¬æ¥è‡ªåå°çš„æ¶ˆæ¯
chrome.runtime.onMessage.addListener((request, sender, sendResponse) => {
  console.log('æ”¶åˆ°æ¶ˆæ¯:', request);

  switch (request.action) {
    case 'clipboardChanged':
      // æ˜¾ç¤ºå‰ªè´´æ¿å˜åŒ–é€šçŸ¥
      showPageNotification('æ£€æµ‹åˆ°å‰ªè´´æ¿å†…å®¹å˜åŒ–', 'info');
      sendResponse({ success: true });
      break;

    case 'refreshClipboardMonitoring':
      // æ›´æ–°ç›‘æ§çŠ¶æ€
      showPageNotification(
        request.enabled ? 'å‰ªè´´æ¿ç›‘æ§å·²å¼€å¯' : 'å‰ªè´´æ¿ç›‘æ§å·²å…³é—­',
        request.enabled ? 'success' : 'info'
      );
      sendResponse({ success: true });
      break;

    default:
      console.warn('æœªçŸ¥æ¶ˆæ¯ç±»å‹:', request.action);
      sendResponse({ success: false, error: 'Unknown action' });
  }

  return true; // ä¿æŒæ¶ˆæ¯é€šé“å¼€æ”¾
});
```

## 6. æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 6.1 é˜²æŠ–å¤„ç†

- **å‰ªè´´æ¿ç›‘æ§**ï¼šä½¿ç”¨é˜²æŠ–å‡å°‘é¢‘ç¹çš„å‰ªè´´æ¿æ£€æŸ¥
- **æ–‡æœ¬è¾“å…¥**ï¼šä½¿ç”¨é˜²æŠ–å‡å°‘é¢‘ç¹çš„æ–‡æœ¬åˆ†æå’ŒUIæ›´æ–°

```javascript
/**
 * é˜²æŠ–å‡½æ•°
 * @param {Function} func è¦æ‰§è¡Œçš„å‡½æ•°
 * @param {number} wait ç­‰å¾…æ—¶é—´
 * @returns {Function} é˜²æŠ–åçš„å‡½æ•°
 */
function debounce(func, wait) {
  let timeout;
  return function executedFunction(...args) {
    const later = () => {
      clearTimeout(timeout);
      func(...args);
    };
    clearTimeout(timeout);
    timeout = setTimeout(later, wait);
  };
}

// ä½¿ç”¨ç¤ºä¾‹
const debouncedProcess = debounce(async (text) => {
  const result = await processClipboardContent(text);
  console.log('å¤„ç†ç»“æœ:', result);
}, 300);
```

### 6.2 æ‡’åŠ è½½å’Œæ¡ä»¶æ¸²æŸ“

- **å†å²è®°å½•**ï¼šä»…åœ¨å±•å¼€æ—¶æ¸²æŸ“å†å²è®°å½•
- **å‰ªè´´æ¿å†å²**ï¼šä»…åœ¨å±•å¼€æ—¶æ¸²æŸ“å‰ªè´´æ¿å†å²

### 6.3 æ‰¹é‡DOMæ“ä½œ

- **ä½¿ç”¨æ–‡æ¡£ç‰‡æ®µ**ï¼šå‡å°‘DOMæ“ä½œæ¬¡æ•°ï¼Œæé«˜æ¸²æŸ“æ€§èƒ½
- **ä¸€æ¬¡æ€§æ›´æ–°**ï¼šæ‰¹é‡æ›´æ–°DOMï¼Œå‡å°‘é‡ç»˜å’Œå›æµ

### 6.4 å­˜å‚¨ä¼˜åŒ–

- **å†å²é™åˆ¶**ï¼šè®¾ç½®å†å²è®°å½•æ•°é‡é™åˆ¶ï¼Œé¿å…å­˜å‚¨è¿‡å¤šæ•°æ®
- **å»é‡å¤„ç†**ï¼šè‡ªåŠ¨ç§»é™¤é‡å¤çš„å†å²è®°å½•ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´

## 7. å®‰å…¨è€ƒè™‘

### 7.1 æƒé™ç®¡ç†

- **æœ€å°æƒé™åŸåˆ™**ï¼šä»…è¯·æ±‚å¿…è¦çš„æƒé™
- **å¯é€‰æƒé™**ï¼šå°†éå¿…è¦æƒé™è®¾ç½®ä¸ºå¯é€‰

### 7.2 æ•°æ®å®‰å…¨

- **å†…å®¹é™åˆ¶**ï¼šå¯¹å¤§å†…å®¹è¿›è¡Œæˆªæ–­å¤„ç†ï¼Œé¿å…å†…å­˜æº¢å‡º
- **é”™è¯¯å¤„ç†**ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†æœºåˆ¶ï¼Œæé«˜ç¨³å®šæ€§

### 7.3 éšç§ä¿æŠ¤

- **æœ¬åœ°å­˜å‚¨**ï¼šæ‰€æœ‰æ•°æ®å­˜å‚¨åœ¨æœ¬åœ°ï¼Œä¸ä¸Šä¼ è‡³æœåŠ¡å™¨
- **ç”¨æˆ·æ§åˆ¶**ï¼šç”¨æˆ·å¯ä»¥éšæ—¶æ¸…ç©ºå†å²è®°å½•å’Œå‰ªè´´æ¿å†å²

## 8. æœªæ¥æ‰©å±•å¯èƒ½æ€§

- **æ›´å¤šæœç´¢å¼•æ“**ï¼šæ”¯æŒæ·»åŠ å’Œç®¡ç†è‡ªå®šä¹‰æœç´¢å¼•æ“
- **æ›´ä¸°å¯Œçš„æ–‡æœ¬åˆ†æ**ï¼šå¢å¼ºå¯¹æ›´å¤šæ ¼å¼çš„æ”¯æŒ
- **äº‘åŒæ­¥**ï¼šæ”¯æŒè·¨è®¾å¤‡åŒæ­¥è®¾ç½®å’Œå†å²è®°å½•
- **ä¸»é¢˜å®šåˆ¶**ï¼šæ”¯æŒæ›´å¤šä¸»é¢˜å’Œè‡ªå®šä¹‰æ ·å¼
- **æ›´å¤šé›†æˆ**ï¼šä¸æ›´å¤šæœåŠ¡å’Œå¹³å°é›†æˆ

## 9. ä»£ç ä¼˜åŒ–å»ºè®®

### 9.1 æ¨¡å—åŒ–é‡æ„

- **åŠŸèƒ½æ‹†åˆ†**ï¼šå°†ä¸åŒåŠŸèƒ½æ‹†åˆ†ä¸ºç‹¬ç«‹æ¨¡å—
- **ä¾èµ–ç®¡ç†**ï¼šä½¿ç”¨ESæ¨¡å—ç³»ç»Ÿç®¡ç†ä¾èµ–
- **ç±»å‹å®šä¹‰**ï¼šæ·»åŠ TypeScriptç±»å‹å®šä¹‰ï¼Œæé«˜ä»£ç å¯ç»´æŠ¤æ€§

### 9.2 æ€§èƒ½ä¼˜åŒ–

- **WebAssembly**ï¼šå¯¹äºå¤æ‚çš„åˆ†è¯ç®—æ³•ï¼Œè€ƒè™‘ä½¿ç”¨WebAssembly
- **Web Workers**ï¼šå°†è€—æ—¶çš„æ–‡æœ¬å¤„ç†ç§»è‡³Web Worker
- **ç¼“å­˜ç­–ç•¥**ï¼šå®ç°æ™ºèƒ½ç¼“å­˜ï¼Œå‡å°‘é‡å¤è®¡ç®—

### 9.3 å…¼å®¹æ€§å¢å¼º

- **æµè§ˆå™¨å…¼å®¹**ï¼šæ·»åŠ å¯¹ä¸åŒæµè§ˆå™¨çš„å…¼å®¹æ€§å¤„ç†
- **é™çº§ç­–ç•¥**ï¼šä¸ºä¸æ”¯æŒç°ä»£APIçš„æµè§ˆå™¨æä¾›é™çº§æ–¹æ¡ˆ

## 10. æ€»ç»“

æœ¬å®ç°æ–¹æ¡ˆæä¾›äº†ä¸€å¥—å®Œæ•´çš„æµè§ˆå™¨æ‰©å±•å‰ªè´´æ¿å†…å®¹åˆ†æä¸åˆ†è¯è§£å†³æ–¹æ¡ˆï¼ŒåŒ…æ‹¬ï¼š

- **æ™ºèƒ½å‰ªè´´æ¿ç›‘æ§**ï¼šå®æ—¶æ£€æµ‹å‰ªè´´æ¿å†…å®¹å˜åŒ–ï¼Œè‡ªåŠ¨å¤„ç†å’Œåˆ†æ
- **å¤šæ ¼å¼æ–‡æœ¬åˆ†æ**ï¼šæ”¯æŒé“¾æ¥ã€è¡¨æ ¼ã€ä»£ç ç­‰å¤šç§æ ¼å¼çš„è¯†åˆ«å’Œå¤„ç†
- **ä¸­æ–‡åˆ†è¯**ï¼šé›†æˆJiebaåˆ†è¯ï¼Œæ”¯æŒé«˜ç²¾åº¦ä¸­æ–‡æ–‡æœ¬åˆ†æ
- **é“¾æ¥è§£æ**ï¼šå®Œæ•´çš„URLè§£æå’Œåˆ†è¯åŠŸèƒ½
- **ç»“æ„åŒ–æ•°æ®æå–**ï¼šå°†éç»“æ„åŒ–æ–‡æœ¬è½¬æ¢ä¸ºç»“æ„åŒ–æ•°æ®
- **æ€§èƒ½ä¼˜åŒ–**ï¼šé˜²æŠ–å¤„ç†ã€æ‡’åŠ è½½ã€æ‰¹é‡DOMæ“ä½œç­‰ä¼˜åŒ–ç­–ç•¥
- **å®‰å…¨å¯é **ï¼šå®Œå–„çš„é”™è¯¯å¤„ç†å’Œéšç§ä¿æŠ¤æœºåˆ¶

è¿™å¥—æ–¹æ¡ˆå¯ä»¥ç›´æ¥åº”ç”¨äºæµè§ˆå™¨æ‰©å±•å¼€å‘ï¼Œå¸®åŠ©å¼€å‘è€…å¿«é€Ÿå®ç°å‰ªè´´æ¿å†…å®¹åˆ†æå’Œæ™ºèƒ½å¤„ç†åŠŸèƒ½ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚